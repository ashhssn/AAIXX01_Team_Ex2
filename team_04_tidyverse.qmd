---
title: "team_04_tidyverse.qmd"
format: html
toc: true
toc-depth: 2
embed-resources: true
author: "Ashsyahid, Owen, Sherwyn, Xuan Yu, Nigel"
number_sections: false
---

# Task 1: Converting EPL Football Results into a League Table

## 1.1 Generate a League Table from the EPL Results

...

## 1.2 Improve Visualization Using `gt` Functions

...

# Task 2: Finding and Visualizing a Real-World Dataset


## Loading and Cleaning of Data by Removing NA Values and Averaging Yearly Data
```{r setup, include=FALSE}
## Load necessary library
library(dplyr)
library(ggplot2)

## Load the data
data <- read.csv("country_temp.csv")

singapore_data <- data %>%
  filter(Country == "Singapore") %>%
  na.omit()

# Convert the 'dt' column to Date format and extract the year
singapore_data$Year <- as.numeric(format(as.Date(singapore_data$dt, format="%Y-%m-%d"), "%Y"))

# Average the data by unique year and round to 1 decimal place
yearly_data <- singapore_data %>%
  group_by(Year) %>%
  summarise(
    AvgTemperature = round(mean(AverageTemperature, na.rm = TRUE), 1),
    AvgTemperatureUncertainty = round(mean(AverageTemperatureUncertainty, na.rm = TRUE), 1)
  )


print(yearly_data)
```

## Generating Scatterplot of the Average Temperature in Singapore
```{r warning=FALSE, message=FALSE}
# Generate the scatter plot
scatter_plot <- ggplot(yearly_data, aes(x = Year, y = AvgTemperature)) +
  geom_point() +
  labs(
    title = "Scatterplot of Average Temperature in Singapore (1825 - 2013)",
    x = "Year",
    y = "Average Temperature (°C)",
    caption = "Data Source: (https://www.kaggle.com/datasets/berkeleyearth/climate-change-earth-surface-temperature-data/data)"
  ) +
  theme_minimal()

# Print the scatter plot
print(scatter_plot)
```

## Improving the Scatterplot with Transparency and Jittering
```{r warning=FALSE, message=FALSE}
improved_scatter_plot <- ggplot(yearly_data, aes(x = Year, y = AvgTemperature)) +
  geom_point(alpha = 0.6, position = position_jitter(width = 0.2, height = 0.2)) +
  labs(
    title = "Improved Scatterplot of Average Temperature in Singapore (1825 - 2013)",
    x = "Year",
    y = "Average Temperature Uncertainty (°C)",
    caption = "Data Source: (https://www.kaggle.com/datasets/berkeleyearth/climate-change-earth-surface-temperature-data/data)"
  ) +
  theme_minimal()

# Print the improved scatter plot
print(improved_scatter_plot)
```

## Adding a Trend Line to the Scatterplot
```{r warning=FALSE, message=FALSE}
# Scatter plot with transparency and jittering, and a trend curve
scatter_plot_with_trend <- ggplot(yearly_data, aes(x = Year, y = AvgTemperature)) +
  geom_point(alpha = 0.6, position = position_jitter(width = 0.2, height = 0.2)) +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(
    title = "Average Temperature in Singapore (1825 - 2013) with Trend Line",
    x = "Year",
    y = "Average Temperature Uncertainty (°C)",
    caption = "Data Source: (https://www.kaggle.com/datasets/berkeleyearth/climate-change-earth-surface-temperature-data/data)"
  ) +
  theme_minimal()
print(scatter_plot_with_trend)
```
## Integrating LOESS curve with Trend Line on Scatterplot

```{r warning=FALSE, message=FALSE}
# Scatter plot with transparency and jittering, and a LOESS smoothing curve
scatter_plot_with_loess <- ggplot(yearly_data, aes(x = Year, y = AvgTemperature)) +
  geom_point(alpha = 0.6, position = position_jitter(width = 0.2, height = 0.2)) +
  geom_smooth(method = "loess", se = FALSE, color = "blue") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(
    title = "Average Temperature in Singapore (1825 - 2013) with LOESS Curve and Trend Line",
    x = "Year",
    y = "Average Temperature(°C)",
    caption = "Data Source: (https://www.kaggle.com/datasets/berkeleyearth/climate-change-earth-surface-temperature-data/data)"
  ) +
  theme_minimal()
print(scatter_plot_with_loess)
```
Data Source: [Climate Change: Earth Surface Temperature Data](https://www.kaggle.com/datasets/berkeleyearth/climate-change-earth-surface-temperature-data/data)

Based on the scatter plot, it can be observed that the average temperature in Singapore has been increasing over the years. The trend line and LOESS curve further illustrate the general upward trend in temperature over the years.

# Task 3: Visualizing Michelson’s Speed-of-Light Measurements

...


