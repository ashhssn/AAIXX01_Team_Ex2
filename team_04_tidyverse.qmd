---
title: "week_10_lab_personal"
author: "Ashsyahid, Owen, Sherwyn, Xuan Yu, Nigel"
date: "2024-07-09"
date-format: "dddd MMM D, YYYY"
format:
  html:
    toc: true
    toc-depth: 3
    toc_location: left
    number-sections: true
    number-depth: 3
    embed-resources: true
---

# Task 1: Converting EPL Football Results into a League Table

## 1.1 Generate a League Table from the EPL Results

generate league table tibble with the following columns:
rank team                    points goal_diff goals_for

```{r}
library(tidyverse)
library(gt)
```

```{r}
epl_results <- read_csv("epl/epl_results.csv")
epl_teams <- read_csv("epl/epl_teams.csv")
```

```{r}
# Prepare the results data
epl_results_long <- epl_results %>%
  pivot_longer(cols = -home_team, names_to = "away_team", values_to = "result") %>%
  separate(result, into = c("home_goals", "away_goals"), sep = "-", convert = TRUE) %>%
  filter(!is.na(home_goals))
```

```{r}
# Calculate home team statistics
home_stats <- epl_results_long %>%
  group_by(home_team) %>%
  summarize(
    points_home = sum(if_else(home_goals > away_goals, 3, if_else(home_goals == away_goals, 1, 0))),
    goals_for_home = sum(home_goals),
    goals_against_home = sum(away_goals)
  )
```

```{r}
# Calculate away team statistics
away_stats <- epl_results_long %>%
  group_by(away_team) %>%
  summarize(
    points_away = sum(if_else(away_goals > home_goals, 3, if_else(away_goals == home_goals, 1, 0))),
    goals_for_away = sum(away_goals),
    goals_against_away = sum(home_goals)
  )
```

```{r}
# Combine home and away statistics
team_stats <- home_stats %>%
  rename(team = home_team) %>%
  full_join(away_stats, by = c("team" = "away_team")) %>%
  mutate(
    points = points_home + points_away,
    goals_for = goals_for_home + goals_for_away,
    goals_against = goals_against_home + goals_against_away,
    goal_diff = goals_for - goals_against
  ) %>%
  select(team, points, goal_diff, goals_for)
```

```{r}
# Add full team names
league_table <- team_stats %>%
  left_join(epl_teams, by = c("team" = "abbr")) %>%
  select(team = name, points, goal_diff, goals_for)
```

```{r}
# Rank the teams
league_table <- league_table %>%
  arrange(desc(points), desc(goal_diff), desc(goals_for)) %>%
  mutate(rank = row_number())
```

```{r}
# Display the league table
league_table
```
...

## 1.2 Improve Visualization Using `gt` Functions

...

# Task 2: Finding and Visualizing a Real-World Dataset

...

# Task 3: Visualizing Michelsonâ€™s Speed-of-Light Measurements

...